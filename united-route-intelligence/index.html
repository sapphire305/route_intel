<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>United Route Intelligence Map</title>

    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
          integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
          crossorigin=""/>

    <!-- Custom CSS -->
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="app-container">
        <!-- Header -->
        <header class="app-header">
            <h1>United Route Intelligence Map</h1>
            <div class="mode-switch" role="group" aria-label="Data mode selector">
                <button id="mode-schedules" class="mode-btn active" data-mode="schedules" aria-pressed="true">
                    Schedules
                </button>
                <button id="mode-offers" class="mode-btn" data-mode="offers" aria-pressed="false">
                    Offers
                </button>
            </div>
        </header>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Sidebar Controls -->
            <aside class="sidebar">
                <form id="search-form" class="controls-form">
                    <h2>Search Parameters</h2>

                    <!-- Origin Input -->
                    <div class="form-group">
                        <label for="origin-input">Origin Airport <span class="required">*</span></label>
                        <input
                            type="text"
                            id="origin-input"
                            placeholder="e.g., SFO"
                            maxlength="3"
                            required
                            aria-describedby="origin-help"
                        >
                        <small id="origin-help">3-letter IATA code</small>
                    </div>

                    <!-- Destination Input -->
                    <div class="form-group">
                        <label for="destination-input">
                            Destination Airport
                            <span id="destination-required" class="required" style="display: none;">*</span>
                            <span id="destination-optional" class="optional">(optional)</span>
                        </label>
                        <input
                            type="text"
                            id="destination-input"
                            placeholder="e.g., ORD"
                            maxlength="3"
                            aria-describedby="destination-help"
                        >
                        <small id="destination-help">3-letter IATA code</small>
                    </div>

                    <!-- Date Input -->
                    <div class="form-group">
                        <label for="date-input">Date <span class="required">*</span></label>
                        <input
                            type="date"
                            id="date-input"
                            required
                            aria-describedby="date-help"
                        >
                        <small id="date-help">Flight date</small>
                    </div>

                    <!-- Departure Time Range -->
                    <div class="form-group">
                        <label>Departure Time Range</label>
                        <div class="time-range">
                            <input
                                type="time"
                                id="dep-time-start"
                                value="00:00"
                                aria-label="Departure time start"
                            >
                            <span>to</span>
                            <input
                                type="time"
                                id="dep-time-end"
                                value="23:59"
                                aria-label="Departure time end"
                            >
                        </div>
                    </div>

                    <!-- Arrival Time Range -->
                    <div class="form-group">
                        <label>Arrival Time Range</label>
                        <div class="time-range">
                            <input
                                type="time"
                                id="arr-time-start"
                                value="00:00"
                                aria-label="Arrival time start"
                            >
                            <span>to</span>
                            <input
                                type="time"
                                id="arr-time-end"
                                value="23:59"
                                aria-label="Arrival time end"
                            >
                        </div>
                    </div>

                    <!-- United Only Filter -->
                    <div class="form-group checkbox-group">
                        <label>
                            <input
                                type="checkbox"
                                id="united-only-filter"
                                aria-describedby="united-only-help"
                            >
                            <span>United Only (UA)</span>
                        </label>
                        <small id="united-only-help">Show only United Airlines flights</small>
                    </div>

                    <!-- Offers Mode Sort (hidden by default) -->
                    <div class="form-group" id="sort-group" style="display: none;">
                        <label for="sort-select">Sort By</label>
                        <select id="sort-select" aria-label="Sort offers by">
                            <option value="price">Price (Low to High)</option>
                            <option value="departure">Departure Time</option>
                            <option value="duration">Duration (Shortest)</option>
                        </select>
                    </div>

                    <!-- Search Button -->
                    <button type="submit" class="btn btn-primary" id="search-btn">
                        Search Flights
                    </button>

                    <!-- Loading State -->
                    <div id="loading-indicator" class="loading" style="display: none;">
                        <div class="spinner"></div>
                        <span>Searching...</span>
                    </div>

                    <!-- Error Message -->
                    <div id="error-message" class="error-message" role="alert" style="display: none;"></div>
                </form>
            </aside>

            <!-- Map and Results -->
            <main class="content-area">
                <!-- Map Container -->
                <div id="map-container" class="map-container">
                    <div id="map"></div>
                    <div class="map-legend">
                        <h3>Map Legend</h3>
                        <div class="legend-item">
                            <span class="legend-marker origin"></span>
                            <span>Origin</span>
                        </div>
                        <div class="legend-item">
                            <span class="legend-marker destination"></span>
                            <span>Destination</span>
                        </div>
                        <div class="legend-item">
                            <span class="legend-line"></span>
                            <span>Flight Route</span>
                        </div>
                        <div class="legend-mode" id="legend-mode">
                            Mode: <strong id="legend-mode-text">Schedules</strong>
                        </div>
                    </div>
                </div>

                <!-- Results Panel -->
                <div id="results-panel" class="results-panel">
                    <div class="results-header">
                        <h2>Results</h2>
                        <span id="results-count" class="results-count">0 flights</span>
                    </div>
                    <div id="results-container" class="results-container">
                        <div class="empty-state">
                            <p>Enter search criteria and click "Search Flights" to see results.</p>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <!-- Leaflet JS -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
            integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
            crossorigin=""></script>

    <!-- App JS Modules -->
    <script type="module" src="airports.js"></script>
    <script type="module" src="dataService.js"></script>
    <script type="module" src="uiComponents.js"></script>
    <script type="module" src="app.js"></script>
</body>
</html>
